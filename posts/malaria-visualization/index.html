<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.75.1" />

    
    
    

<title>Malaria Visualization • Mingxuan Yang</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Malaria Visualization"/>
<meta name="twitter:description" content="Malaria is a fatal disease caused by infected mosquitoes. This blog is aimed to gain more comprehension about this epidemic through 3 visualizations."/>

<meta property="og:title" content="Malaria Visualization" />
<meta property="og:description" content="Malaria is a fatal disease caused by infected mosquitoes. This blog is aimed to gain more comprehension about this epidemic through 3 visualizations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Mingxuan-Yang.github.io/posts/malaria-visualization/" />
<meta property="article:published_time" content="2020-10-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-10-01T00:00:00+00:00" /><meta property="og:site_name" content="website" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.71157e768c4e111a23c3531b95e0cbb59bbef3c9e6901d36247cb53d6b6be258.css" integrity="sha256-cRV&#43;doxOERojw1MbleDLtZu&#43;88nmkB02JHy1PWtr4lg=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://Mingxuan-Yang.github.io/">Mingxuan Yang</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://Mingxuan-Yang.github.io/img/photo.png" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Mingxuan Yang</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	
	
	<a href="https://github.com/Mingxuan-Yang" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/mingxuan-yang-9468391a1" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	<a href="mailto:mingxuan.yang@duke.edu" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Malaria Visualization</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Oct 1, 2020
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/python">PYTHON</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/visualization">visualization</a>
           
      
          <a class="badge badge-tag" href="/tags/malaria">malaria</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 6 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Malaria is a fatal disease caused by infected mosquitoes. It has remained with human in a long history and is one of the biggest causes of death. Almost half of the world’s population, according to <em>the World Health Organization</em> (WHO), is at the risk of catching Malaria. To gain more comprehension about this powerful enemy, <em>the Wellcome Trust and Sage Bionetworks</em> have hosted a <a href="https://www.synapse.org/#!Synapse:syn16788291/wiki/583310">Data Challenge</a> based on the relevant <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2018/2018-11-13">Malaria datasets</a>.</p>
<p>Three datasets are provided in this project. These datasets contain information about the incidences and deaths of Malaria by country for all ages across the world. To get a comprehensive understanding about how broadly and deeply Malaria influences the world, a worldwide map plot representing the deaths caused by Malaria for each country can be meaningful.</p>
<p>The dataset we are using to draw the map plot is called <code>malaria_deaths.csv</code>, which offers the age-standardized number of deaths caused by Malaria per 100,000 people for each country from 1990 to 2016. However, these information is not enough for obtaining a map plot. Additional dataset containing the geographic information of each country is needed for further use. The geographic data can be obtained at <a href="https://www.naturalearthdata.com/downloads/110m-cultural-vectors/">Natural Earth website</a>, where the green button with &ldquo;Download countries&rdquo; is the access to what we need. Then a merged dataset can be gained through the following code.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> geopandas <span style="color:#f92672">as</span> gpd

malaria_deaths <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;Data/malaria_deaths.csv&#39;</span>)
<span style="color:#75715e"># shorter column name</span>
malaria_deaths<span style="color:#f92672">.</span>rename(columns <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Deaths - Malaria - Sex: Both - Age: Age-standardized (Rate) (per 100,000 people)&#39;</span>:
                                 <span style="color:#e6db74">&#39;Deaths per 100,000&#39;</span>}, inplace <span style="color:#f92672">=</span> True)
malaria_deaths[<span style="color:#e6db74">&#39;bin&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>cut(malaria_deaths[<span style="color:#e6db74">&#39;Deaths per 100,000&#39;</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">300</span>],
                               labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;0-25&#39;</span>, <span style="color:#e6db74">&#39;25-50&#39;</span>, <span style="color:#e6db74">&#39;50-100&#39;</span>, <span style="color:#e6db74">&#39;100-150&#39;</span>, <span style="color:#e6db74">&#39;150-200&#39;</span>, <span style="color:#e6db74">&#39;200-250&#39;</span>, <span style="color:#e6db74">&#39;&gt;250&#39;</span>])
<span style="color:#75715e"># geographic data</span>
gdf <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>read_file(<span style="color:#e6db74">&#39;Data/ne_10m_admin_0_countries/ne_10m_admin_0_countries.shp&#39;</span>)[[<span style="color:#e6db74">&#39;ADM0_A3&#39;</span>, <span style="color:#e6db74">&#39;geometry&#39;</span>]]<span style="color:#f92672">.</span>to_crs(<span style="color:#e6db74">&#39;+proj=robin&#39;</span>)
gdf <span style="color:#f92672">=</span> gdf[gdf[<span style="color:#e6db74">&#39;ADM0_A3&#39;</span>] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;ATA&#39;</span>] <span style="color:#75715e">## Antarctica is not necessary for our analysis</span>

<span style="color:#75715e"># generalized function to get merged data in different year</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">merged_data</span>(year):
    df <span style="color:#f92672">=</span> malaria_deaths[malaria_deaths[<span style="color:#e6db74">&#39;Year&#39;</span>] <span style="color:#f92672">==</span> year][[<span style="color:#e6db74">&#39;Entity&#39;</span>, <span style="color:#e6db74">&#39;Code&#39;</span>, <span style="color:#e6db74">&#39;bin&#39;</span>]]
    <span style="color:#66d9ef">return</span> gdf<span style="color:#f92672">.</span>merge(df, left_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ADM0_A3&#39;</span>, right_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Code&#39;</span>, how <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;left&#39;</span>)
</code></pre></div><p>Using <code>merged_data</code> function, the resulting merged dataset with death information as well as geographic information for each country can be applied to construct a map plot for each year. The figure is shown below.</p>
<p><img src="/img/map_animation.gif" alt="error"></p>
<p>The gray part of <strong>Figure 1</strong> means that the Malaria death data for the corresponding countries is not available. Among those without missing data, we can see that the severity of Malaria is greater in the Africa area. Almost all of cases with death number greater than 100 per 100,000 population appear in Africa. This should arise the attention of the corresponding health organizations. Besides, as can be noted, the global death condition in 2015 is much better than that in 1990. This demonstrates the effort made by WHO in containing this epidemic.</p>
<p>After the overall view of the geographic distribution of Malaria, we are also interested in the most vulnerable age group for this disease. According to the relevant documents, children is the demographic group most at risk of severe infection. This conclusion can be proved by data.</p>
<p>Here the data used is called <code>malaria_deaths_age.csv</code>. It provides information about country-level Malaria deaths for different age groups from 1990 to 2016. Since the focus of our exploration here is the overall distribution of deaths for demographic groups, the country information is not helpful and can be combined using <code>groupby</code> command as following.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">malaria_deaths_age <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;Data/malaria_deaths_age.csv&#39;</span>, usecols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;entity&#39;</span>, <span style="color:#e6db74">&#39;code&#39;</span>, <span style="color:#e6db74">&#39;year&#39;</span>, <span style="color:#e6db74">&#39;age_group&#39;</span>, <span style="color:#e6db74">&#39;deaths&#39;</span>])
deaths_sum <span style="color:#f92672">=</span> malaria_deaths_age<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;year&#39;</span>, <span style="color:#e6db74">&#39;age_group&#39;</span>])[<span style="color:#e6db74">&#39;deaths&#39;</span>]<span style="color:#f92672">.</span>agg(np<span style="color:#f92672">.</span>sum)
years <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>unique(malaria_deaths_age[<span style="color:#e6db74">&#39;year&#39;</span>])
ages <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>unique(malaria_deaths_age[<span style="color:#e6db74">&#39;age_group&#39;</span>])
</code></pre></div><p>Based on <code>deaths_sum</code>, <code>years</code> and <code>ages</code>, a line chart can be plotted to represent the demographic death distribution.</p>
<p><img src="/img/line_animation.gif" alt="error"></p>
<p>From <strong>Figure 2</strong>, we can get the conclusion that children are indeed the most vulnerable object when faced with Malaria, and the level of vulnerability reduces as they grow up according to the lower position of lines with older age. Besides, the total number of deaths for children less than 5 years old is greater than the sum of all the other groups, indicating that infancy is the period that requires more attention during their development stages.</p>
<p>Besides Malaria&rsquo;s geographic and demographic distribution, we may also interest in the economic influence on Malaria infection. In this part, the country-level incidence of Malaria per 1,000 population is employed as the indicator of Malaria severity. In addition to the Malaria dataset <code>malaria_inc.csv</code>, we need more information about the economic situation of each country. The most widely used economic index from an overall perspective is the <a href="https://en.wikipedia.org/wiki/Gross_domestic_product">Gross Domestic Product</a> (GDP) per capita. This indicator is slightly corrected based on <a href="https://en.wikipedia.org/wiki/Purchasing_power_parity">Purchasing Power Parity</a> (PPP) in this project. Besides, additional knowledge about the continent of countries can be added as well. These datasets can be obtained at the <a href="https://github.com/Mingxuan-Yang/malaria_visualization">project&rsquo;s Github pages</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">malaria_inc <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;Data/malaria_inc.csv&#39;</span>)
malaria_inc<span style="color:#f92672">.</span>rename(columns <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Incidence of malaria (per 1,000 population at risk) (per 1,000 population at risk)&#39;</span>:
                   <span style="color:#e6db74">&#39;Incidence per 1,000&#39;</span>}, inplace <span style="color:#f92672">=</span> True)

<span style="color:#75715e"># data of population and GPD per capita</span>
data_pop_gdp <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;Data/data_pop_gdp.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Windows-1252&#39;</span>)
data_pop_gdp <span style="color:#f92672">=</span> data_pop_gdp<span style="color:#f92672">.</span>replace([<span style="color:#e6db74">&#39;Gross domestic product based on purchasing-power-parity (PPP) per capita GDP&#39;</span>],
                                    <span style="color:#e6db74">&#39;GDP&#39;</span>)

<span style="color:#75715e"># add region of country</span>
region <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;Data/region.csv&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Windows-1252&#39;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">data_year</span>(year):
    <span style="color:#75715e"># merge datasets</span>
    df_pop_gdp <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Country&#39;</span>: np<span style="color:#f92672">.</span>array(data_pop_gdp[<span style="color:#e6db74">&#39;Country&#39;</span>][::<span style="color:#ae81ff">2</span>]),
                               <span style="color:#e6db74">&#39;GDP&#39;</span>: np<span style="color:#f92672">.</span>array(data_pop_gdp[str(year)][::<span style="color:#ae81ff">2</span>]),
                               <span style="color:#e6db74">&#39;Population&#39;</span>: np<span style="color:#f92672">.</span>array(data_pop_gdp[str(year)][<span style="color:#ae81ff">1</span>:][::<span style="color:#ae81ff">2</span>])})
    df_target <span style="color:#f92672">=</span> df_pop_gdp<span style="color:#f92672">.</span>merge(malaria_inc[malaria_inc[<span style="color:#e6db74">&#39;Year&#39;</span>] <span style="color:#f92672">==</span> year][[<span style="color:#e6db74">&#39;Entity&#39;</span>,<span style="color:#e6db74">&#39;Incidence per 1,000&#39;</span>]], 
                                 left_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Country&#39;</span>, right_on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Entity&#39;</span>)
    df_target[<span style="color:#e6db74">&#39;GDP&#39;</span>] <span style="color:#f92672">=</span> df_target[<span style="color:#e6db74">&#39;GDP&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>astype(float)
    df_target[<span style="color:#e6db74">&#39;Population&#39;</span>] <span style="color:#f92672">=</span> df_target[<span style="color:#e6db74">&#39;Population&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>astype(float)
    df_target <span style="color:#f92672">=</span> df_target<span style="color:#f92672">.</span>merge(region, on <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Country&#39;</span>)
    group_codes <span style="color:#f92672">=</span> {k: idx <span style="color:#66d9ef">for</span> idx, k <span style="color:#f92672">in</span> enumerate(df_target[<span style="color:#e6db74">&#39;Region&#39;</span>]<span style="color:#f92672">.</span>unique())}
    df_target[<span style="color:#e6db74">&#39;Region&#39;</span>] <span style="color:#f92672">=</span> df_target[<span style="color:#e6db74">&#39;Region&#39;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: group_codes[x])
    
    top <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([df_target<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#39;Population&#39;</span>, ascending <span style="color:#f92672">=</span> False)[:<span style="color:#ae81ff">4</span>],
                     df_target<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#39;Incidence per 1,000&#39;</span>, ascending <span style="color:#f92672">=</span> False)[:<span style="color:#ae81ff">1</span>],
                     df_target<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#39;GDP&#39;</span>, ascending <span style="color:#f92672">=</span> False)[:<span style="color:#ae81ff">3</span>]])<span style="color:#f92672">.</span>drop_duplicates()
    
    <span style="color:#66d9ef">return</span> df_target, group_codes, top
</code></pre></div><p>The resulting function <code>data_year</code> will return three elements, the first of which is the main dataset that we will plot on, while the other two elements are for sake of legend and annotation setting. The final figure is shown as below.</p>
<p><img src="/img/scatter_animation.gif" alt="error"></p>
<p>In <strong>Figure 3</strong>, GDP per capita and incidence of Malaria per 1,000 people are converted to logarithmic scale for clearer visualization. The point sizes represent their relative population. Several points are labelled with their country name due to higher population or greater fortune or severer Malaria situation. As is shown, the incidence of Malaria seems to be negatively correlated with the economic condition, indicating that wealthier countries will be less risky in terms of Malaria infection. Besides, the whole group of points slightly move downwards to the right from 2000 to 2015. This might reflect the global improvement in infectious disease control and financial situation.</p>
<p>From the above visualization, we can gain a general comprehension about the dynamic spread and distribution of Malaria. WHO has made a significant progress in controlling this epidemic from the global perspective. However, for the eradication of Malaria, there is still a long way to go. In the future, more detailed analysis and visualization might be needed.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/euler-project-problem-85/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Euler Project Problem 85 using Python</span>
    </a>
    
    
</div>


  

  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
